{% load static %}

<html lang="en">
<head>
	<title>PoupeComprando - Registrar</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'fonts/font-awesome-4.7.0/css/font-awesome.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/animate/animate.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/css-hamburgers/hamburgers.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/select2/select2.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/util.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/login.css' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/inputmask/5.0.7-beta.0/inputmask.min.js"></script>
</head>
<body>
	<div class="limiter">
        <div class="container-login100" style="flex-direction:column !important; gap:2rem;">
            <div class="wrap-login100">
			
                <div class=" validate-form">
                    <span class="login100-form-title">
						Registre-se Agora!
					</span>
                
                    <form method="post" enctype="multipart/form-data" action="{% url 'registerLoja' %}">
                        {% csrf_token %}
                        
                        <label for="nomeLoja">Nome da Loja</label>
                        <div class="wrap-input100 validate-input" data-validate="Nome da loja não pode ser vazio">
							<input class="input100" type="text" name="nomeLoja" placeholder="Nome da Loja">
							<span class="focus-input100"></span>
							<span class="symbol-input100">
								<i class="fa fa-user" aria-hidden="true"></i>
							</span>
						</div>

                        <label for="username">CNPJ</label>
						<div class="wrap-input100 validate-input" data-validate="CNPJ precisa ser válido.">
							<input class="input100" type="text" id="cnpj" name="username" placeholder="CNPJ">
							<span class="focus-input100"></span>
							<span class="symbol-input100">
                                <i class="fa fa-id-card" aria-hidden="true"></i>
							</span>
						</div>
                        <script>
                            document.getElementById('cnpj').addEventListener('input', function (e) {
                                let value = e.target.value.replace(/\D/g, '');
                                value = value.replace(/^(\d{2})(\d)/, "$1.$2");
                                value = value.replace(/^(\d{2})\.(\d{3})(\d)/, "$1.$2.$3");
                                value = value.replace(/\.(\d{3})(\d)/, ".$1/$2");
                                value = value.replace(/(\d{4})(\d)/, "$1-$2");
                                e.target.value = value;
                            });
                        </script>

                        <label for="nome">Nome do Proprietário</label>
                        <div class="wrap-input100 validate-input" data-validate="Nome não pode ser vazio.">
                            <input class="input100" type="text" name="nome" placeholder="Nome do Proprietário">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-user" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="email">Email da Loja</label>
                        <div class="wrap-input100 validate-input" data-validate="Email precisa ser válido: ex@abc.xyz">
                            <input class="input100" type="email" name="email" placeholder="Email da Loja">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-envelope" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="telefone">Celular</label>
                        <div class="wrap-input100 validate-input" data-validate="Celular precisa ser válido.">
                            <input class="input100" type="text" id="celular" name="telefone" placeholder="Celular">
                            <script>
                                document.addEventListener('DOMContentLoaded', function () {
                                    var telefoneInput = document.getElementById('celular');
                                    Inputmask({
                                        mask: "+55 (99) 99999-9999",
                                        placeholder: "",
                                        showMaskOnHover: false,
                                        showMaskOnFocus: false,
                                        clearIncomplete: true
                                    }).mask(telefoneInput);
                                });
                            </script>
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-phone" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="cep">CEP</label>
                        <div class="wrap-input100 validate-input" data-validate="CEP is required">
                            <input class="input100" type="text" name="cep" id="cep" placeholder="CEP">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-home" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="endereco">Endereço</label>
                        <div class="wrap-input100 validate-input" data-validate="Endereço is required">
                            <input class="input100" type="text" name="endereco" id="endereco" placeholder="Endereço">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-road" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="bairro">Bairro</label>
                        <div class="wrap-input100 validate-input" data-validate="Logradouro is required">
                            <input class="input100" type="text" name="bairro" id="bairro" placeholder="Bairro">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-map-marker" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="numero">Número</label>
                        <div class="wrap-input100 validate-input" data-validate="Número is required">
                            <input class="input100" type="text" name="numero" id="numero" placeholder="Número">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-building" aria-hidden="true"></i>
                            </span>
                        </div>
                        <script>
                            document.getElementById('cep').addEventListener('blur', function(e) {
                                var cep = this.value.replace(/\D/g, '');
                                if (cep.length === 8) {
                                    fetch(`https://viacep.com.br/ws/${cep}/json/`)
                                    .then(response => response.json())
                                    .then(data => {
                                        if (!data.erro) {
                                            document.getElementById('endereco').value = data.logradouro;
                                            document.getElementById('bairro').value = data.bairro;
                                        } else {
                                            alert("CEP não encontrado.");
                                        }
                                    })
                                    .catch(() => alert("Erro ao buscar o CEP."));
                                } else {
                                    alert("Formato de CEP inválido.");
                                }
                            });
                        </script>

                        <label for="fotoInput">Logo da Loja</label>
                        <div class="wrap-input100" id="fotoInput">
                            <div class="input100" style="padding-left:30px !important;">
                            <i style="margin-right:20px;" class="fa fa-image" aria-hidden="true"></i>
                            <input type="file" name="foto" accept="image/*">
                            </div>  
                        </div>

                        <label for="especialidadesDiv">Categorias</label>
                        <div class="mb-3" id="especialidadesDiv">
                            <label for="especialidades" id="especialidadesLabel" class="form-label"></label>
                            <div id="especialidades" style="max-height:12rem; overflow-y:scroll;">
                                {% for categoria in categorias %}
                                    <div class="form-check medico" style="display: flex; align-items: center; justify-content: start; padding-left: 0 !important;">
                                        <input type="checkbox" style="margin:.5rem !important;" class="form-check-input registrar-check" id="{{ categoria.id }}" name="categorias" value="{{ categoria.id }}">
                                        <label style="margin-left:.5rem !important;" class="form-check-label" for="{{ categoria.id }}">{{ categoria.nome }}</label>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>

                        <label for="password1">Digite sua Senha</label>
                        <div class="wrap-input100 validate-input" id="password1" data-validate="Valid email is required: ex@abc.xyz">
                            <input class="input100" type="password" name="password1" placeholder="Senha">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-lock" aria-hidden="true"></i>
                            </span>
                        </div>

                        <label for="password2">Confirme sua Senha</label>
                        <div class="wrap-input100 validate-input" id="password2" data-validate="Password is required">
                            <input class="input100" type="password" name="password2" placeholder="Confirmar Senha">
                            <span class="focus-input100"></span>
                            <span class="symbol-input100">
                                <i class="fa fa-lock" aria-hidden="true"></i>
                            </span>
                        </div>
                        
                        <button type="submit">Enviar</button>
                    </form>

                    <div class="text-center pt-4">
                        <a style="font-size:.9rem !important;" class="txt2" href="{% url 'login' %}">
                            Já tenho uma Conta!
                            <i class="fa fa-long-arrow-right m-l-5" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
            </div>
            <a style="color:#fff !important; font-size:1.2rem !important" href="{% url 'tipoPerfil' %}">Voltar</a>
        </div>
    </div>

    <script>
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
            }
        });
    </script>

	<script src="{% static 'vendor/jquery/jquery-3.2.1.min.js' %}"></script>
	<script src="{% static 'vendor/bootstrap/js/popper.js' %}"></script>
	<script src="{% static 'vendor/bootstrap/js/bootstrap.min.js' %}"></script>
	<script src="{% static 'vendor/select2/select2.min.js' %}"></script>
	<script src="{% static 'vendor/tilt/tilt.jquery.min.js' %}"></script>
	<script>
		$('.js-tilt').tilt({
			scale: 1.1
		})
	</script>
	<script src="{% static 'js/login.js' %}"></script>

    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="d-flex flex-column align-items-center" style="gap:1rem;">
                        <img style="max-height:5rem;" src="{% static 'img/check (1).png' %}">
                        {% if messages %}
                        <div class="messages">
                            {% for message in messages %}
                            {% if message.tags == 'success' %}
                            <span style="text-align:center; font-size:1.2rem !important;">{{ message }}</span>
                            {% endif %}
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="d-flex flex-column align-items-center" style="gap:1rem;">
                        <img style="max-height:5rem;" src="{% static 'img/close.png' %}">
                        {% if messages %}
                        <div class="messages">
                            {% for message in messages %}
                            {% if message.tags == 'error' %}
                            <span style="text-align:center; font-size:1.2rem !important;">{{ message }}</span>
                            {% endif %}
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', (event) => {
            {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'success' %}
                var successModal = new bootstrap.Modal(document.getElementById('successModal'));
                successModal.show();
                {% elif message.tags == 'error' %}
                var errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
                errorModal.show();
                {% endif %}
            {% endfor %}
            {% endif %}
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>