{% extends 'core/base-dashboard.html' %}

{% block 'conteudo' %}
<div class="container d-flex flex-column" style=" width:100%; max-width:60rem">
    <div class="d-flex justify-content-center">
        <h2>Pedidos Recebidos:</h2>
    </div>

    {% for pedido in pedidos %}
    {%if pedido.status == 'confirmado' or pedido.status == 'pendente'%}
    <div class="mt-4">
        <h4 style="color:#000">Pedido #{{ pedido.id }}</h4>
        <div class="d-flex justify-content-between">
            <p style="color:#333 !important">Cliente:</p> 
            <span style="color:#333" class="fw-bold">{{ pedido.cliente.nome}}</span>
        </div>
        <div class="d-flex justify-content-between">
            <p style="color:#333">Pontos Ganhos:</p> 
            <span style="color:#333;" class="fw-bold">{{ pedido.pontos }}</span>
        </div>
        <div class="d-flex justify-content-between">
            <p style="color:#333 !important;">Status:</span> 
                
            <p style="color:#333 !important; text-transform:capitalize;" class="fw-bold">{{ pedido.status}}</p>
        </div>
        {% if pedido.status == 'confirmado' %}
    <form action="{% url 'pedidos_pendentes' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="pedido_id" value="{{ pedido.id }}">
        <button type="submit" class="btn btn-success">Marcar como Entregue</button>
    </form>
    {% endif %}
        <div class="d-flex justify-content-between">
            <p style="color:#333 !important;">Meio de Pagamento:</span> 
            {%if pedido.pagamento == 'pontos'%}<p style="color:#333 !important;" class="fw-bold">Pontos</p>
            {%else%}<p style="color:#333 !important;" class="fw-bold">Reais</p>
            {%endif%}
        </div>
        <div class="d-flex my-3 justify-content-between">
            <p class="mb-0" style="color:#333">Data do Pedido:</p>  
            <span class="fw-bold" style="color:#333 !important;">{{ pedido.data }}</span>
        </div>
        <div class="d-flex my-3 justify-content-between">
            <p style="color:#333">Localização:</p> 
            <span class="fw-bold" style="color:#333 !important;">{{ pedido.localizacao }}</span>
        </div>
        <div class="d-flex my-3 justify-content-between">
            <p style="color:#333">Total do Pedido:</p> 
            <span class="fw-bold" style="color:#333 !important;">R$ {{ pedido.total }}</span>
        </div>

        <ul>
            <h4>Itens do Pedido:</h4>
            {% for item in pedido.itempedido_set.all %}
                <li style="color:#333">{{ item.produto.nome }} - Quantidade: {{ item.quantidade }}, Preço Unitário: R$ {{ item.preco_unitario }}</li>
            {% endfor %}
        </ul>
    </div>
    {%endif%}

    {% empty %}
    <p>Não há pedidos realizados.</p>
    {% endfor %}
</div>

{% endblock %}